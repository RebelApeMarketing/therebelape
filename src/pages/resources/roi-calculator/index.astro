---
import Base from '../../../layouts/Base.astro';
import Hero from '../../../components/sections/Hero.astro';
import SocialProofBar from '../../../components/sections/SocialProofBar.astro';
import Button from '../../../components/ui/Button.astro';

// SEO
const title = "ROI Calculator for Contractors | Rebel Ape Marketing";
const description = "Calculate exactly how many leads you need to hit your revenue goals. Most contractors need fewer leads than they think—the challenge is getting them consistently.";
const canonical = "https://therebelape.com/resources/roi-calculator/";
const image = "https://RebelApeCDN.b-cdn.net/featured-roi-calculator.webp";
const type = "website";
const robots = "index, follow";
---

<Base {title} {description} {canonical} {image} {type} {robots}>
  <section>
    <Hero
      backgroundImage="https://RebelApeCDN.b-cdn.net/bg-gorilla-direct.webp"
      title="Calculate What It <span class='text-rebel-green'>Actually Takes</span>"
      subtitle="See How Many Leads You Need to Hit Your Revenue Goals"
      description="Most contractors think they need hundreds of leads to grow. The reality? It's usually <strong>way fewer than that.</strong> The real problem isn't lead volume—it's <strong>predictability.</strong> Use this calculator to see your numbers."
      features={[
        'Real-Time Calculations',
        'Personalized Results',
        'Actionable Insights'
      ]}
      buttonText="Schedule a Strategy Session"
      buttonIcon="calendar"
      buttonHref="/schedule/"
      fetchpriority="high"
    />
    <SocialProofBar />

    <!-- Intro Section - 2/3 + 1/3 Layout -->
    <section class="py-16 md:py-24 section-checkers">
      <div class="max-w-7xl mx-auto px-4">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-12 items-start">
          <!-- Left Column (2/3) -->
          <div class="lg:col-span-2">
            <h2 class="text-4xl md:text-5xl font-black text-gray-900 mb-6">
              Calculate What It Actually Takes to Hit Your Revenue Goals
            </h2>
            <p class="text-lg text-gray-700 mb-6">
              Most contractors think they need hundreds of leads to reach their growth goals. The reality? It's usually way fewer than that.
            </p>
            <p class="text-lg text-gray-700 mb-6">
              The real problem isn't lead volume—it's predictability. You can't scale a business on word-of-mouth alone because you can't control when referrals come in. Some months you're slammed. Other months you're scrambling for work. That inconsistency makes it impossible to plan hiring, invest in equipment, or grow with confidence.
            </p>
            <p class="text-lg text-gray-700 mb-6">
              This calculator shows you exactly what it takes to hit your monthly revenue target. You'll probably be surprised how achievable the numbers are when you have a system generating leads consistently instead of relying on random referrals.
            </p>
            <p class="text-lg text-gray-700 mb-4 font-semibold">
              Here's what we're calculating for you:
            </p>
            <ul class="space-y-3 mb-6">
              <li class="flex gap-3">
                <span class="text-[#32C55F] text-xl font-bold flex-shrink-0">✓</span>
                <span class="text-gray-700">How many jobs you need to close each week, month, and year</span>
              </li>
              <li class="flex gap-3">
                <span class="text-[#32C55F] text-xl font-bold flex-shrink-0">✓</span>
                <span class="text-gray-700">How many estimates you need to give to hit those numbers</span>
              </li>
              <li class="flex gap-3">
                <span class="text-[#32C55F] text-xl font-bold flex-shrink-0">✓</span>
                <span class="text-gray-700">How many leads you need coming in to make it all happen</span>
              </li>
            </ul>
            <p class="text-lg text-gray-700">
              The math is simple. The hard part is building a marketing system that delivers these leads month after month, not just when business happens to be good. Use the calculator below to see your numbers. Then we'll talk about what it takes to build a system that hits them consistently.
            </p>
          </div>

          <!-- Right Column (1/3) -->
          <div class="lg:col-span-1">
            <div class="bg-gradient-to-br from-slate-50 to-slate-100 p-6 rounded-lg border border-slate-300 shadow-xl">
              <h3 class="text-xl font-bold text-gray-900 mb-4">Why This Matters</h3>
              <p class="text-gray-700 mb-4">
                When you know your numbers, you can:
              </p>
              <ul class="space-y-3 text-gray-700">
                <li class="flex gap-3">
                  <span class="text-[#32C55F] font-bold flex-shrink-0">✓</span>
                  <span>Plan crew hiring with confidence</span>
                </li>
                <li class="flex gap-3">
                  <span class="text-[#32C55F] font-bold flex-shrink-0">✓</span>
                  <span>Invest in equipment without fear</span>
                </li>
                <li class="flex gap-3">
                  <span class="text-[#32C55F] font-bold flex-shrink-0">✓</span>
                  <span>Turn down bad-fit jobs (because you know more are coming)</span>
                </li>
                <li class="flex gap-3">
                  <span class="text-[#32C55F] font-bold flex-shrink-0">✓</span>
                  <span>Actually take time off without revenue dropping</span>
                </li>
                <li class="flex gap-3">
                  <span class="text-[#32C55F] font-bold flex-shrink-0">✓</span>
                  <span>Build a business, not just a job</span>
                </li>
              </ul>
              <p class="text-gray-700 mt-4 text-sm">
                Most contractors are closer to their goals than they think. They just need consistent leads instead of feast-or-famine cycles.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Calculator Section -->
    <section class="py-16 md:py-24 section-slate">
      <div class="max-w-5xl mx-auto px-4">
        <div class="text-center mb-12">
          <h2 class="text-4xl md:text-5xl font-black text-gray-900 mb-4">
            Your ROI Calculator
          </h2>
          <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">
            Enter your numbers below and see exactly what it takes to hit your goals.
          </p>
        </div>

        <!-- Calculator Form -->
        <div class="bg-white rounded-2xl shadow-2xl overflow-hidden">
          <div class="h-2 bg-[#32C55F]"></div>

          <form
            id="roi-calculator-form"
            name="roi-calculator"
            method="POST"
            data-netlify="true"
            netlify-honeypot="bot-field"
            class="p-8 md:p-12"
          >
            <!-- Honeypot field for spam protection -->
            <input type="hidden" name="bot-field" />
            <input type="hidden" name="form-name" value="roi-calculator" />

            <!-- Hidden fields for calculated results -->
            <input type="hidden" name="monthly-jobs" id="hidden-monthly-jobs" />
            <input type="hidden" name="monthly-estimates" id="hidden-monthly-estimates" />
            <input type="hidden" name="monthly-leads" id="hidden-monthly-leads" />
            <input type="hidden" name="weekly-jobs" id="hidden-weekly-jobs" />
            <input type="hidden" name="weekly-estimates" id="hidden-weekly-estimates" />
            <input type="hidden" name="weekly-leads" id="hidden-weekly-leads" />
            <input type="hidden" name="yearly-jobs" id="hidden-yearly-jobs" />
            <input type="hidden" name="yearly-estimates" id="hidden-yearly-estimates" />
            <input type="hidden" name="yearly-leads" id="hidden-yearly-leads" />

            <!-- Calculator Inputs -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
              <!-- Monthly Revenue Goal -->
              <div>
                <label for="monthly-goal" class="block text-sm font-semibold text-gray-900 mb-2">
                  Monthly Revenue Goal <span class="text-red-600">*</span>
                </label>
                <div class="relative">
                  <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-semibold">$</span>
                  <input
                    type="text"
                    id="monthly-goal"
                    name="monthly-goal"
                    required
                    inputmode="numeric"
                    class="w-full pl-8 pr-4 py-3 bg-white border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#32C55F] focus:border-transparent text-lg"
                    placeholder="50,000"
                  />
                </div>
                <p class="text-sm text-gray-500 mt-1">Typical goals: $25K-100K/month</p>
              </div>

              <!-- Average Job Size -->
              <div>
                <label for="avg-job-size" class="block text-sm font-semibold text-gray-900 mb-2">
                  Average Job Size <span class="text-red-600">*</span>
                </label>
                <div class="relative">
                  <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-semibold">$</span>
                  <input
                    type="text"
                    id="avg-job-size"
                    name="avg-job-size"
                    required
                    inputmode="numeric"
                    class="w-full pl-8 pr-4 py-3 bg-white border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#32C55F] focus:border-transparent text-lg"
                    placeholder="8,000"
                  />
                </div>
                <p class="text-sm text-gray-500 mt-1">What's a typical project worth?</p>
              </div>

              <!-- Closing Rate -->
              <div>
                <label for="closing-rate" class="block text-sm font-semibold text-gray-900 mb-2">
                  Closing Rate <span class="text-red-600">*</span>
                </label>
                <div class="relative">
                  <input
                    type="text"
                    id="closing-rate"
                    name="closing-rate"
                    required
                    inputmode="numeric"
                    value="30"
                    class="w-full pl-4 pr-8 py-3 bg-white border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#32C55F] focus:border-transparent text-lg"
                    placeholder="30"
                  />
                  <span class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 font-semibold">%</span>
                </div>
                <p class="text-sm text-gray-500 mt-1">What % of estimates do you close?</p>
              </div>

              <!-- Industry -->
              <div>
                <label for="industry" class="block text-sm font-semibold text-gray-900 mb-2">
                  Industry <span class="text-red-600">*</span>
                </label>
                <select
                  id="industry"
                  name="industry"
                  required
                  class="w-full px-4 py-3 bg-white border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#32C55F] focus:border-transparent text-lg appearance-none cursor-pointer"
                  style="background-image: url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27currentColor%27 stroke-width=%272%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3e%3cpolyline points=%276 9 12 15 18 9%27%3e%3c/polyline%3e%3c/svg%3e'); background-repeat: no-repeat; background-position: right 1rem center; background-size: 1em;"
                >
                  <option value="">Select your industry...</option>
                  <option value="Roofing">Roofing</option>
                  <option value="HVAC">HVAC</option>
                  <option value="Plumbing">Plumbing</option>
                  <option value="Electrical">Electrical</option>
                  <option value="Painting">Painting</option>
                  <option value="Landscaping">Landscaping</option>
                  <option value="Surveying">Surveying</option>
                  <option value="General Contracting">General Contracting</option>
                  <option value="Other">Other</option>
                </select>
              </div>
            </div>

            <!-- Results Section (Initially Hidden) -->
            <div id="results-section" class="hidden">
              <!-- Callout -->
              <div id="results-callout" class="bg-[#069c4b] text-white p-6 rounded-xl mb-8">
                <p class="text-lg md:text-xl font-semibold text-center">
                  To hit your <span id="callout-goal">$0</span>/month goal, you need about <strong><span id="callout-leads">0</span> leads per month</strong>. That's only <strong><span id="callout-weekly-leads">0</span> leads per week</strong>. Probably fewer than you thought, right?
                </p>
              </div>

              <!-- Results Grid -->
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <!-- Weekly -->
                <div class="bg-gradient-to-br from-slate-50 to-slate-100 p-6 rounded-xl border border-slate-200">
                  <h4 class="text-lg font-bold text-gray-900 mb-4 text-center">Weekly</h4>
                  <div class="space-y-3">
                    <div class="flex justify-between items-center">
                      <span class="text-gray-600">Jobs Needed</span>
                      <span id="weekly-jobs" class="text-2xl font-black text-[#069c4b]">0</span>
                    </div>
                    <div class="flex justify-between items-center">
                      <span class="text-gray-600">Estimates Needed</span>
                      <span id="weekly-estimates" class="text-2xl font-black text-[#069c4b]">0</span>
                    </div>
                    <div class="flex justify-between items-center">
                      <span class="text-gray-600">Leads Needed</span>
                      <span id="weekly-leads" class="text-2xl font-black text-[#069c4b]">0</span>
                    </div>
                  </div>
                </div>

                <!-- Monthly -->
                <div class="bg-gradient-to-br from-[#069c4b]/10 to-[#32C55F]/10 p-6 rounded-xl border-2 border-[#32C55F]">
                  <h4 class="text-lg font-bold text-gray-900 mb-4 text-center">Monthly</h4>
                  <div class="space-y-3">
                    <div class="flex justify-between items-center">
                      <span class="text-gray-600">Jobs Needed</span>
                      <span id="monthly-jobs" class="text-2xl font-black text-[#069c4b]">0</span>
                    </div>
                    <div class="flex justify-between items-center">
                      <span class="text-gray-600">Estimates Needed</span>
                      <span id="monthly-estimates" class="text-2xl font-black text-[#069c4b]">0</span>
                    </div>
                    <div class="flex justify-between items-center">
                      <span class="text-gray-600">Leads Needed</span>
                      <span id="monthly-leads" class="text-2xl font-black text-[#069c4b]">0</span>
                    </div>
                  </div>
                </div>

                <!-- Yearly -->
                <div class="bg-gradient-to-br from-slate-50 to-slate-100 p-6 rounded-xl border border-slate-200">
                  <h4 class="text-lg font-bold text-gray-900 mb-4 text-center">Yearly</h4>
                  <div class="space-y-3">
                    <div class="flex justify-between items-center">
                      <span class="text-gray-600">Jobs Needed</span>
                      <span id="yearly-jobs" class="text-2xl font-black text-[#069c4b]">0</span>
                    </div>
                    <div class="flex justify-between items-center">
                      <span class="text-gray-600">Estimates Needed</span>
                      <span id="yearly-estimates" class="text-2xl font-black text-[#069c4b]">0</span>
                    </div>
                    <div class="flex justify-between items-center">
                      <span class="text-gray-600">Leads Needed</span>
                      <span id="yearly-leads" class="text-2xl font-black text-[#069c4b]">0</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Post-Results Copy -->
              <div class="bg-slate-50 p-6 rounded-xl border border-slate-200 mb-8">
                <h3 class="text-2xl font-bold text-gray-900 mb-4">The Challenge: Getting These Leads Consistently</h3>
                <p class="text-gray-700 mb-4">
                  The math is straightforward. You need <span id="copy-leads" class="font-bold text-[#069c4b]">X</span> leads per month to hit your goal.
                </p>
                <p class="text-gray-700 mb-4">
                  But here's what most contractors face: their lead flow is completely unpredictable. Three jobs from referrals one month, nothing the next. A burst from a neighborhood project, then crickets for weeks.
                </p>
                <p class="text-gray-700 mb-4">
                  You can't build a real business on that rollercoaster.
                </p>
                <p class="text-gray-700">
                  That's what a complete marketing system does—it turns lead generation from random chance into predictable revenue. Targeted ads, conversion-optimized website, local SEO, and tracking all working together to deliver consistent lead flow.
                </p>
              </div>

              <!-- Contact Info Section -->
              <div class="border-t-2 border-slate-200 pt-8">
                <h3 class="text-2xl font-bold text-gray-900 mb-2 text-center">Get Your Personalized Results</h3>
                <p class="text-gray-600 mb-6 text-center">Enter your info below and we'll email you these results along with next steps.</p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                  <!-- Name -->
                  <div>
                    <label for="name" class="block text-sm font-semibold text-gray-900 mb-2">
                      Name <span class="text-red-600">*</span>
                    </label>
                    <input
                      type="text"
                      id="name"
                      name="name"
                      required
                      class="w-full px-4 py-3 bg-white border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#32C55F] focus:border-transparent text-lg"
                      placeholder="John Smith"
                    />
                  </div>

                  <!-- Email -->
                  <div>
                    <label for="email" class="block text-sm font-semibold text-gray-900 mb-2">
                      Email <span class="text-red-600">*</span>
                    </label>
                    <input
                      type="email"
                      id="email"
                      name="email"
                      required
                      class="w-full px-4 py-3 bg-white border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#32C55F] focus:border-transparent text-lg"
                      placeholder="john@company.com"
                    />
                  </div>

                  <!-- Phone -->
                  <div>
                    <label for="phone" class="block text-sm font-semibold text-gray-900 mb-2">
                      Phone <span class="text-red-600">*</span>
                    </label>
                    <input
                      type="tel"
                      id="phone"
                      name="phone"
                      required
                      class="w-full px-4 py-3 bg-white border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#32C55F] focus:border-transparent text-lg"
                      placeholder="(555) 123-4567"
                    />
                  </div>
                </div>

                <div class="text-center">
                  <button
                    type="submit"
                    id="submit-btn"
                    class="bg-yellow-400 hover:bg-yellow-500 text-slate-900 font-bold py-4 px-8 rounded-lg text-lg transition duration-200 ease-in-out transform hover:scale-105 inline-flex items-center gap-2"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                      <path d="M1.5 8.67v8.58a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V8.67l-8.928 5.493a3 3 0 0 1-3.144 0L1.5 8.67Z" />
                      <path d="M22.5 6.908V6.75a3 3 0 0 0-3-3h-15a3 3 0 0 0-3 3v.158l9.714 5.978a1.5 1.5 0 0 0 1.572 0L22.5 6.908Z" />
                    </svg>
                    Email Me These Results
                  </button>
                </div>
              </div>
            </div>

            <!-- Calculate Button (shown before results) -->
            <div id="calculate-btn-wrapper" class="text-center">
              <button
                type="button"
                id="calculate-btn"
                class="bg-[#069c4b] hover:bg-[#057a3b] text-white font-bold py-4 px-8 rounded-lg text-lg transition duration-200 ease-in-out transform hover:scale-105"
              >
                Calculate My Numbers
              </button>
            </div>
          </form>
        </div>

        <!-- Disclaimer -->
        <p class="text-sm text-gray-500 text-center mt-6 max-w-3xl mx-auto">
          These calculations are based on industry averages. Your actual results may vary based on your specific market, competition, and pricing. Use these numbers as a starting point for planning your growth.
        </p>
      </div>
    </section>

    <!-- Success Message (Initially Hidden) -->
    <div id="success-message" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
      <div class="bg-white rounded-2xl p-8 max-w-md w-full text-center shadow-2xl">
        <div class="w-16 h-16 bg-[#32C55F] rounded-full flex items-center justify-center mx-auto mb-6">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-white">
            <path fill-rule="evenodd" d="M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z" clip-rule="evenodd" />
          </svg>
        </div>
        <h3 class="text-2xl font-bold text-gray-900 mb-2">Results Sent!</h3>
        <p class="text-gray-600 mb-4">Check your inbox for your personalized ROI breakdown.</p>
        <p class="text-gray-500 text-sm">Redirecting you to schedule a call...</p>
        <div class="mt-4">
          <div class="w-full bg-gray-200 rounded-full h-2">
            <div id="redirect-progress" class="bg-[#32C55F] h-2 rounded-full transition-all duration-100" style="width: 0%"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- CTA Section -->
    <section class="py-16 md:py-24 section-checkers">
      <div class="max-w-4xl mx-auto px-4 text-center">
        <h2 class="text-4xl md:text-5xl font-black text-gray-900 mb-6">
          Ready to Build Your Lead System?
        </h2>
        <p class="text-lg md:text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
          Want to see what a consistent lead generation system looks like for your business? Schedule a strategy call and we'll break down exactly what it takes to hit the numbers you just calculated.
        </p>
        <div class="flex justify-center">
          <Button text="Schedule a Strategy Session" icon="calendar" href="/schedule/" />
        </div>
      </div>
    </section>
  </section>
</Base>

<script>
  // Format number with commas
  function formatNumber(num: number): string {
    return Math.round(num).toLocaleString('en-US');
  }

  // Parse number from formatted string
  function parseFormattedNumber(str: string): number {
    return parseFloat(str.replace(/,/g, '')) || 0;
  }

  // Format input as currency
  function formatCurrencyInput(input: HTMLInputElement): void {
    let value = input.value.replace(/[^0-9]/g, '');
    if (value) {
      input.value = parseInt(value).toLocaleString('en-US');
    }
  }

  // Initialize
  document.addEventListener('DOMContentLoaded', () => {
    const monthlyGoalInput = document.getElementById('monthly-goal') as HTMLInputElement;
    const avgJobSizeInput = document.getElementById('avg-job-size') as HTMLInputElement;
    const closingRateInput = document.getElementById('closing-rate') as HTMLInputElement;
    const industrySelect = document.getElementById('industry') as HTMLSelectElement;
    const calculateBtn = document.getElementById('calculate-btn') as HTMLButtonElement;
    const calculateBtnWrapper = document.getElementById('calculate-btn-wrapper') as HTMLDivElement;
    const resultsSection = document.getElementById('results-section') as HTMLDivElement;
    const form = document.getElementById('roi-calculator-form') as HTMLFormElement;
    const successMessage = document.getElementById('success-message') as HTMLDivElement;

    // Format currency inputs on blur
    [monthlyGoalInput, avgJobSizeInput].forEach(input => {
      input.addEventListener('blur', () => formatCurrencyInput(input));
      input.addEventListener('input', () => {
        // Allow only numbers and commas while typing
        input.value = input.value.replace(/[^0-9,]/g, '');
      });
    });

    // Closing rate: only allow numbers
    closingRateInput.addEventListener('input', () => {
      closingRateInput.value = closingRateInput.value.replace(/[^0-9]/g, '');
      let value = parseInt(closingRateInput.value);
      if (value > 100) closingRateInput.value = '100';
    });

    // Calculate button click
    calculateBtn.addEventListener('click', () => {
      // Validate inputs
      const monthlyGoal = parseFormattedNumber(monthlyGoalInput.value);
      const avgJobSize = parseFormattedNumber(avgJobSizeInput.value);
      const closingRate = parseFloat(closingRateInput.value) || 0;
      const industry = industrySelect.value;

      if (!monthlyGoal || !avgJobSize || !closingRate || !industry) {
        alert('Please fill in all calculator fields.');
        return;
      }

      // Calculate results
      const monthlyJobs = monthlyGoal / avgJobSize;
      const monthlyEstimates = monthlyJobs / (closingRate / 100);
      const monthlyLeads = monthlyEstimates * 1.5;

      const weeklyJobs = monthlyJobs / 4.33;
      const weeklyEstimates = monthlyEstimates / 4.33;
      const weeklyLeads = monthlyLeads / 4.33;

      const yearlyJobs = monthlyJobs * 12;
      const yearlyEstimates = monthlyEstimates * 12;
      const yearlyLeads = monthlyLeads * 12;

      // Update display
      (document.getElementById('weekly-jobs') as HTMLElement).textContent = formatNumber(weeklyJobs);
      (document.getElementById('weekly-estimates') as HTMLElement).textContent = formatNumber(weeklyEstimates);
      (document.getElementById('weekly-leads') as HTMLElement).textContent = formatNumber(weeklyLeads);

      (document.getElementById('monthly-jobs') as HTMLElement).textContent = formatNumber(monthlyJobs);
      (document.getElementById('monthly-estimates') as HTMLElement).textContent = formatNumber(monthlyEstimates);
      (document.getElementById('monthly-leads') as HTMLElement).textContent = formatNumber(monthlyLeads);

      (document.getElementById('yearly-jobs') as HTMLElement).textContent = formatNumber(yearlyJobs);
      (document.getElementById('yearly-estimates') as HTMLElement).textContent = formatNumber(yearlyEstimates);
      (document.getElementById('yearly-leads') as HTMLElement).textContent = formatNumber(yearlyLeads);

      // Update callout
      (document.getElementById('callout-goal') as HTMLElement).textContent = '$' + formatNumber(monthlyGoal);
      (document.getElementById('callout-leads') as HTMLElement).textContent = formatNumber(monthlyLeads);
      (document.getElementById('callout-weekly-leads') as HTMLElement).textContent = formatNumber(weeklyLeads);

      // Update copy
      (document.getElementById('copy-leads') as HTMLElement).textContent = formatNumber(monthlyLeads);

      // Update hidden fields for form submission
      (document.getElementById('hidden-monthly-jobs') as HTMLInputElement).value = formatNumber(monthlyJobs);
      (document.getElementById('hidden-monthly-estimates') as HTMLInputElement).value = formatNumber(monthlyEstimates);
      (document.getElementById('hidden-monthly-leads') as HTMLInputElement).value = formatNumber(monthlyLeads);
      (document.getElementById('hidden-weekly-jobs') as HTMLInputElement).value = formatNumber(weeklyJobs);
      (document.getElementById('hidden-weekly-estimates') as HTMLInputElement).value = formatNumber(weeklyEstimates);
      (document.getElementById('hidden-weekly-leads') as HTMLInputElement).value = formatNumber(weeklyLeads);
      (document.getElementById('hidden-yearly-jobs') as HTMLInputElement).value = formatNumber(yearlyJobs);
      (document.getElementById('hidden-yearly-estimates') as HTMLInputElement).value = formatNumber(yearlyEstimates);
      (document.getElementById('hidden-yearly-leads') as HTMLInputElement).value = formatNumber(yearlyLeads);

      // Show results, hide calculate button
      resultsSection.classList.remove('hidden');
      calculateBtnWrapper.classList.add('hidden');

      // Scroll to results
      resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });

    // Form submission
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
      submitBtn.disabled = true;
      submitBtn.textContent = 'Sending...';

      try {
        const formData = new FormData(form);

        const response = await fetch('/', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: new URLSearchParams(formData as any).toString()
        });

        if (response.ok) {
          // Show success message
          successMessage.classList.remove('hidden');

          // Animate progress bar and redirect
          const progressBar = document.getElementById('redirect-progress') as HTMLDivElement;
          let progress = 0;
          const interval = setInterval(() => {
            progress += 2;
            progressBar.style.width = progress + '%';
            if (progress >= 100) {
              clearInterval(interval);
              window.location.href = '/schedule/';
            }
          }, 100); // 5 seconds total (100% / 2% per 100ms = 50 intervals * 100ms = 5000ms)
        } else {
          throw new Error('Form submission failed');
        }
      } catch (error) {
        alert('Something went wrong. Please try again.');
        submitBtn.disabled = false;
        submitBtn.textContent = 'Email Me These Results';
      }
    });
  });
</script>
