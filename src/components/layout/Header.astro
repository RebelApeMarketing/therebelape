---
import PreHeader from './PreHeader.astro';
import Button from '../ui/Button.astro';
import Breadcrumbs from './Breadcrumbs.astro';
---

<header class="w-full border-b border-gray-200">

    <PreHeader />

    <!-- Main Header -->
    <div class="max-w-7xl mx-auto px-6 py-1 flex items-center justify-between">
        
        <!-- Logo Left -->
        <div class="shrink-0 py-2">
            <a href="/">
                <img 
                src="https://RebelApeCDN.b-cdn.net/Rebel%20Website/Branding/rebel-ape-logo-cmyk.svg" 
                alt="Rebel Ape Marketing Logo"
                class="w-70 h-auto"
                width="75" 
                height="auto"
                />
            </a>
        </div>

        <!-- Navigation -->
        <nav class="hidden lg:flex gap-6 ml-auto text-lg font-light tracking-wide">
            <a href="/" class="hover:text-rebel-green transition">Home</a>

            <!-- Services Dropdown -->
            <div class="relative group">
                <a href="/services/" class="hover:text-rebel-green transition flex items-center gap-1">
                    Services
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4">
                        <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
                    </svg>
                </a>
                <div class="absolute left-0 mt-2 w-64 bg-white border border-gray-200 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 divide-y divide-gray-100">
                    <a href="/services/website-design/" class="block px-4 py-2 hover:bg-gray-50 hover:text-rebel-green transition">Web Design</a>
                    <a href="/services/ppc/" class="block px-4 py-2 hover:bg-gray-50 hover:text-rebel-green transition">PPC</a>
                    <a href="/services/ppc/local-service-ads/" class="block px-4 py-2 hover:bg-gray-50 hover:text-rebel-green transition">Local Service Ads</a>
                    <a href="/services/seo/" class="block px-4 py-2 hover:bg-gray-50 hover:text-rebel-green transition">SEO</a>
                    <a href="/services/google-business-profile/" class="block px-4 py-2 hover:bg-gray-50 hover:text-rebel-green transition">Google Business Profile</a>
                    <a href="/services/social-media/" class="block px-4 py-2 hover:bg-gray-50 hover:text-rebel-green transition">Social Media</a>
                </div>
            </div>

            <a href="/silverback-authority-method/" class="hover:text-rebel-green transition">Process</a>
            <a href="/about/" class="hover:text-rebel-green transition">About</a>
            <a href="/blog/" class="hover:text-rebel-green transition">Blog</a>
            <a href="/results/" class="hover:text-rebel-green transition">Results</a>
            <a href="/contact/" class="hover:text-rebel-green transition">Contact</a>
        </nav>

        <!-- Right section: Mobile Menu Button -->
        <div class="flex items-center gap-2 ml-auto lg:ml-0">
          <!-- Mobile Menu Button -->
          <button id="mobileMenuBtn" class="lg:hidden inline-flex items-center justify-center p-2 rounded border border-gray-200" aria-label="Open menu" aria-expanded="false" aria-controls="mobileMenuPanel">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
              <path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd" />
            </svg>
          </button>
        </div>
    </div>

    <Breadcrumbs />

    <!-- Mobile Offâ€‘Canvas Menu -->
    <div id="mobileMenuOverlay" class="fixed inset-0 bg-black/40 opacity-0 pointer-events-none transition-opacity lg:hidden z-40"></div>

    <aside id="mobileMenuPanel" class="fixed top-0 right-0 h-full w-80 max-w-[85vw] bg-gray-950 dark:bg-gray-950 shadow-xl translate-x-full transition-transform lg:hidden z-50" aria-hidden="true">
      <div class="flex items-center justify-between px-4 h-14 border-b border-gray-800 dark:border-gray-800">
        <span class="font-semibold text-white dark:text-white">Menu</span>
        <button id="mobileMenuClose" class="inline-flex items-center justify-center p-2 rounded border border-gray-700 dark:border-gray-700" aria-label="Close menu">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6 text-white dark:text-white">
            <path fill-rule="evenodd" d="M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
          </svg>
        </button>
      </div>
      <nav class="px-4 py-4 grid gap-4 text-base">
        <a href="/" class="py-2 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">Home</a>

        <!-- Services submenu -->
        <div class="py-2">
          <a href="/services/" class="text-gray-400 text-sm mb-2 block hover:text-rebel-green transition">Services</a>
          <div class="pl-4 grid gap-2">
            <a href="/services/website-design/" class="py-1 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">Web Design</a>
            <a href="/services/ppc/" class="py-1 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">PPC</a>
            <a href="/services/ppc/local-service-ads/" class="py-1 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">Local Service Ads</a>
            <a href="/services/seo/" class="py-1 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">SEO</a>
            <a href="/services/google-business-profile/" class="py-1 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">Google Business Profile</a>
            <a href="/services/social-media/" class="py-1 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">Social Media</a>
          </div>
        </div>

        <a href="/silverback-authority-method/" class="py-2 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">Process</a>
        <a href="/about/" class="py-2 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">About</a>
        <a href="/blog/" class="py-2 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">Blog</a>
        <a href="/results/" class="py-2 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">Results</a>
        <a href="/contact/" class="py-2 text-gray-100 dark:text-gray-100 hover:text-rebel-green dark:hover:text-white transition">Contact</a>
      </nav>
    </aside>

    <script is:inline>
      const btn = document.getElementById('mobileMenuBtn');
      const panel = document.getElementById('mobileMenuPanel');
      const closeBtn = document.getElementById('mobileMenuClose');
      const overlay = document.getElementById('mobileMenuOverlay');

      function openMenu() {
        panel.classList.remove('translate-x-full');
        overlay.classList.remove('pointer-events-none');
        overlay.classList.add('opacity-100');
        btn.setAttribute('aria-expanded', 'true');
        panel.setAttribute('aria-hidden', 'false');
        closeBtn.focus();
      }

      function closeMenu() {
        panel.classList.add('translate-x-full');
        overlay.classList.add('pointer-events-none');
        overlay.classList.remove('opacity-100');
        btn.setAttribute('aria-expanded', 'false');
        panel.setAttribute('aria-hidden', 'true');
      }

      btn?.addEventListener('click', openMenu);
      closeBtn?.addEventListener('click', closeMenu);
      overlay?.addEventListener('click', closeMenu);
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeMenu();
      });
    </script>

</header>
